{
  "proto": {
      "id": "?latest"
  },
  "$where": [
    "graph npa:graph {",
   "  ?_np_iri npa:hasValidSignatureForPublicKey ?pubkey .",
   "  ?latest npa:hasValidSignatureForPublicKey ?pubkey .",
   "  ?latest dct:created ?date .",
   "}",
   "graph npa:networkGraph {",
   "  ?latest (npx:supersedes)* ?_np_iri .",
   "}",
   "filter not exists {",
   "  graph npa:networkGraph {",
   "    ?newer npx:supersedes ?latest .",
   "  }",
   "  graph npa:graph {",
   "    ?newer npa:hasValidSignatureForPublicKey ?pubkey .",
   "  }",
   "}",
   "filter not exists {",
   "  graph npa:graph {",
   "    ?retraction npa:hasHeadGraph ?rh .",
   "    ?retraction npa:hasValidSignatureForPublicKey ?pubkey .",
   "  }",
   "  graph ?rh {",
   "    ?retraction np:hasAssertion ?ra .",
   "  }",
   "  graph ?ra {",
   "    ?somebody npx:retracts ?latest .",
   "  }",
   "}"
  ],
  "$orderby": [ "?date" ],
  "grlc": "#+ summary: Returns the latest nanopublication.",
   "#+ method: GET",
   "#+ pagination: 1000",
   "#+ endpoint_in_url: False",
  "$prefixes": {
    "np" : "http://www.nanopub.org/nschema#",
    "npa" : "http://purl.org/nanopub/admin/",
    "npx" : "http://purl.org/nanopub/x/",
    "dct" : "http://purl.org/dc/terms/"
  }
}
